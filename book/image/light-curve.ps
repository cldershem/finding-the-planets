%!PS-Adobe-1.0

/square {
    [/s /y /x] dup length 0 add dict begin {exch def} forall
    x s 2 div sub y s 2 div sub moveto
    s 0 rlineto
    0 s rlineto
    s neg 0 rlineto
    closepath
    end
} def

/transit {
    [/d /S /s /y /x] dup length 0 add dict begin {exch def} forall
    x y S square
    x d add y s square
    end
} def

/dash {
    [/h /y /x] dup length 0 add dict begin {exch def} forall
    gsave
    currentlinewidth 2 div setlinewidth
    [3 5] 0 setdash
    x y moveto
    x y h add lineto
    stroke
    grestore
    end
} def

save /clean-slate exch def
75 25.4 div dup scale

/x0 30 def
/dx 25 def
/y0 297 2 div def
/s 5 2 div def
/S 25 2 div def

[
    [0 S neg]
    [1 S s add 2 div neg]
    [2 S s sub 2 div neg]
    [3 0]
    [4 S s sub 2 div]
    [5 S s add 2 div]
    [6 S]
] {
    aload pop [/position /index] dup length 1 add dict begin {exch def} forall
    /x x0 index dx mul add def
    x y0 s S position transit
    end
} forall

stroke
clean-slate restore
