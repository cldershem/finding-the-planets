<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Collage - Finding the Planets</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A book accompanying a workshop to find the planets around Trappist-1.">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="../">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        

        
        <!-- MathJax -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch store.js from local - TODO add CDN when 2.x.x is available on cdnjs -->
        <script src="store.js"></script>

        <!-- Custom JS script -->
        

    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = store.get('theme');
            if (theme === null || theme === undefined) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = store.get('sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li class="affix"><a href="./about.html">What is this book about</a></li><li><a href="./background.html"><strong>1.</strong> Background</a></li><li><ul class="section"><li><a href="./background/trappist-1.html"><strong>1.1.</strong> Trappist-1</a></li><li><a href="./background/kepler.html"><strong>1.2.</strong> Kepler Spacecraft</a></li></ul></li><li><a href="./science.html"><strong>2.</strong> Science</a></li><li><ul class="section"><li><a href="./science/discovery.html"><strong>2.1.</strong> Exo-planet Discovery</a></li><li><a href="./science/position.html"><strong>2.2.</strong> Observing Position</a></li><li><a href="./science/doppler.html"><strong>2.3.</strong> Doppler Effect</a></li></ul></li><li><a href="./transit.html"><strong>3.</strong> Transit Method</a></li><li><ul class="section"><li><a href="./transit/light_curve.html"><strong>3.1.</strong> What To Look For</a></li></ul></li><li><a href="./finding.html"><strong>4.</strong> Finding Planets</a></li><li><ul class="section"><li><a href="./finding/fits.html"><strong>4.1.</strong> FITS</a></li><li><a href="./finding/csv.html"><strong>4.2.</strong> CSV</a></li><li><a href="./finding/image.html"><strong>4.3.</strong> Image</a></li><li><a href="./finding/collage.html" class="active"><strong>4.4.</strong> Collage</a></li><li><a href="./finding/brightness.html"><strong>4.5.</strong> Brightness</a></li></ul></li><li><a href="./setup.html">Setup</a></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page" tabindex="-1">
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush"></i>
                    </div>

                    <h1 class="menu-title">Finding the Planets</h1>

                    <div class="right-buttons">
                        <i id="print-button" class="fa fa-print" title="Print this book"></i>
                    </div>
                </div>

                <div id="content" class="content">
                    <a class="header" href="collage.html#collage" id="collage"><h1>Collage</h1></a>
<p>In this chapter we will create a Collage of all the image in the long cadence
file. Although it is a bit of a side-track, we will learn valuable things by
looking at the image.</p>
<p>If you want, you can take a <a href="image/collage.png">sneak peek</a>.</p>
<p>We will not go into details of reading the data and writing the transformed
data. We assume that the previous chapters have given enough examples to learn
from. Instead we are going to focus on processing the data.</p>
<a class="header" href="collage.html#processing" id="processing"><h2>Processing</h2></a>
<p>There are a few questions we need to answer before we can create our collage.</p>
<ol>
<li>For a row of data and a column in that row, which pixel should we paint?</li>
<li>What color should we paint that pixel?</li>
</ol>
<a class="header" href="collage.html#position" id="position"><h3>Position</h3></a>
<p>When we created the single image, we did not have to think about positioning
explicitly. Because we want to make a collage we have some work to do.</p>
<p>First of all, lets state some facts.</p>
<ol>
<li>Each image is 11x11 pixels.</li>
<li>There are 3599 rows of images.</li>
</ol>
<p>The interesting thing about 3599 is that is 61x59. So we could make our collage
almost a square with 61 columns and 59 rows of single images. With 11x11 images
as base our collage will come in at 61x11 = 671 by 59x11 = 649.</p>
<p>There are two factors that determine the position of the pixel. The which row
that data is from, and which column the data is in.</p>
<p>We will start with the row. Because we have 61 images along the x-axis of our
collage, the <code>X</code>-offset will be</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
let offset_X = row_index % 61;
#}</code></pre></pre>
<p>After 61 rows, we need to increase the <code>Y</code>-offset with one. This amounts to</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
let offset_Y = row_index / 61;
#}</code></pre></pre>
<p>Now for the offset within the image. The image is 11x11. So given an original
index in the row, we have for the</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
let offset_x = original_index % 11;
let offset_y = original_index / 11;
#}</code></pre></pre>
<p>Now we can calculate the target index. For each <code>offset_Y</code> we need to go down an
entire 11 rows in our collage. This is 11x61x11 = 7381. For each <code>offset_X</code> we
need to shift 11 pixels down. For each <code>offset_y</code> we need to go down an entire
row. This is 61x11 = 671. Finally, for each <code>offset_x</code> we need to shift 1 pixel
down. All together this is</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
let target_index = offset_Y * 7381 +
                   offset_X * 11 +
                   offset_y * 671 +
                   offsetx
#}</code></pre></pre>
<p>With these calculations we know where to paint the image pixel.</p>
<a class="header" href="collage.html#color" id="color"><h3>Color</h3></a>
<p>From our experience from creating an image we have a fairly good idea which
color to use. The only difference between the collage and the single image is
that we want to use the same scale for each image.</p>
<p>So instead of dividing our value by the maximum value of a single image, we
should divide by the global maximum.</p>
<p>Create a separate executable that will determine the global maximum of all the
measurements that we can use in determining the color of the pixel.</p>
<a class="header" href="collage.html#further considerations" id="further considerations"><h2>Further Considerations</h2></a>
<p>The following suggestions might help your understanding of the problem we
facing, i.e. detecting planets in our image.</p>
<p>Take a long good look at your collage. Write down what you notice about the
image. Ask yourself some questions and discuss your observations with somebody
else.</p>
<p>Why do we need a global maximum? What would happen if we would stick to the
maximum per image? What would that look like, and what would it tell you?</p>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a rel="prev" href="./finding/image.html" class="mobile-nav-chapters previous">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="./finding/brightness.html" class="mobile-nav-chapters next">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="./finding/image.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="./finding/brightness.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        

        

        

        <script src="highlight.js"></script>
        <script src="book.js"></script>
    </body>
</html>
